import{a as h}from"./chunk-BV5OK7LD.js";import{c as f,d as U,e as A,n as v,o as b,p as d,u as c,v as S}from"./chunk-NKJEXYBB.js";import{b as m,k as l}from"./chunk-465FC233.js";import{a as n,b as u,ia as p,na as i,v as s}from"./chunk-LA57Z5ON.js";var e=U({source:"Auth",events:{"Set Autenticacion Usuario":f(),"Unset Autenticacion Usuario":A()}});var g="auth",k={autenticacionUsuario:null},F=S(k,c(e.setAutenticacionUsuario,(o,t)=>u(n({},o),{autenticacionUsuario:t.usuario})),c(e.unsetAutenticacionUsuario,o=>u(n({},o),{autenticacionUsuario:null})));var x=d(g),R=b(x,o=>o.autenticacionUsuario);var I=class o{constructor(t,r,a){this.router=t;this.httpClient=r;this.store=a;this.authUsuario$=this.store.select(R)}authUsuario$;baseURL=h.ApiBaseURL;handleAutenticacion(t){return t[0]?(this.store.dispatch(e.setAutenticacionUsuario({usuario:t[0]})),localStorage.setItem("token",t[0].token),t[0]):null}login(t){return this.httpClient.get(`${this.baseURL}/usuarios?email=${t.email}&password=${t.password}`).pipe(s(r=>{let a=this.handleAutenticacion(r);if(a)return a;throw new Error("Los datos son invalidos")}))}logout(){this.store.dispatch(e.unsetAutenticacionUsuario()),localStorage.removeItem("token"),this.router.navigate(["auth","login"])}verificarToken(){return this.httpClient.get(`${this.baseURL}/usuarios?token=${localStorage.getItem("token")}`).pipe(s(t=>!!this.handleAutenticacion(t)))}static \u0275fac=function(r){return new(r||o)(i(l),i(m),i(v))};static \u0275prov=p({token:o,factory:o.\u0275fac,providedIn:"root"})};export{g as a,F as b,I as c};
