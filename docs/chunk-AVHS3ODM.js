import{a as X}from"./chunk-BV5OK7LD.js";import{a as E}from"./chunk-C266OGI4.js";import{a as st,b as lt,d as mt,e as ut,g as dt,h as ct,i as pt,j as ft,k as Ct,l as _t,m as ht,n as gt,o as Ut,p as vt,q as bt,r as xt,s as Dt,t as St,u as Et,v as Mt,w as It,x as Rt,y as Tt}from"./chunk-MT3NPNYF.js";import"./chunk-5L3ICMBY.js";import{$ as y,aa as Y,ca as Z,ea as tt,fa as F,ha as et,ia as it,ka as ot,la as at,ma as rt,na as nt}from"./chunk-P6QF5PR7.js";import"./chunk-EJJBCPAK.js";import{b as Q,i as w,k as W,n as H}from"./chunk-465FC233.js";import{Da as D,Ea as S,Eb as g,H as O,Jb as p,Mb as o,Nb as a,Ob as f,Pb as U,Qb as v,Sb as V,Vb as _,Xb as C,a as M,ad as J,b as I,cd as K,fc as r,hb as s,hc as d,ia as G,ib as u,ja as R,na as q,oc as $,pc as B,ta as h,ua as T,wa as z,zb as l}from"./chunk-LA57Z5ON.js";function kt(t,e){t&1&&r(0," Este campo es obligatorio ")}function jt(t,e){t&1&&r(0," Este campo es obligatorio ")}function Pt(t,e){t&1&&r(0," Este campo es obligatorio ")}var N=class t{constructor(e,i,n){this.matDialogRef=e;this.formBuilder=i;this.data=n;this.usuarioForm=this.formBuilder.group({nombre:[null,[F.required]],apellido:[null,[F.required]],email:[null,[F.required]]}),this.patchFormValue()}usuarioForm;get estaEditando(){return!!this.data?.usuarioEditado}patchFormValue(){this.data?.usuarioEditado&&this.usuarioForm.patchValue(this.data?.usuarioEditado)}guardar(){this.usuarioForm.invalid?this.usuarioForm.markAllAsTouched():this.matDialogRef.close(I(M({},this.usuarioForm.value),{id:this.estaEditando?this.data.usuarioEditado.id:E(4),fecha_creado:this.estaEditando?this.data.usuarioEditado.fecha_creado:new Date}))}static \u0275fac=function(i){return new(i||t)(u(dt),u(nt),u(ct))};static \u0275cmp=h({type:t,selectors:[["app-usuario-dialog"]],decls:30,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],[1,"row"],[1,"col-6"],[1,"example-form-field","casilla"],["formControlName","nombre","matInput","","type","text"],[1,"example-form-field"],["formControlName","apellido","matInput","","type","text"],[1,"col-12"],["formControlName","email","matInput","","type","email"],["mat-dialog-actions",""],["mat-dialog-close","","mat-raised-button",""],["mat-raised-button","",3,"click"]],template:function(i,n){if(i&1&&(o(0,"h1",0),r(1),a(),o(2,"div",1)(3,"form",2)(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),r(8,"Nombre"),a(),f(9,"input",6),o(10,"mat-error"),l(11,kt,1,0),a()(),o(12,"mat-form-field",7)(13,"mat-label"),r(14,"Apellido"),a(),f(15,"input",8),o(16,"mat-error"),l(17,jt,1,0),a()()(),o(18,"div",9)(19,"mat-form-field",7)(20,"mat-label"),r(21,"Email"),a(),f(22,"input",10),o(23,"mat-error"),l(24,Pt,1,0),a()()()()()(),o(25,"div",11)(26,"button",12),r(27,"Cancelar"),a(),o(28,"button",13),_("click",function(){return n.guardar()}),r(29,"Guardar"),a()()),i&2){let m,c,L;s(),d("",n.data!=null&&n.data.usuarioEditado?"Editar":"Crear"," Usuario"),s(2),g("formGroup",n.usuarioForm),s(8),p((m=n.usuarioForm.get("nombre"))!=null&&m.hasError("required")?11:-1),s(6),p((c=n.usuarioForm.get("apellido"))!=null&&c.hasError("required")?17:-1),s(7),p((L=n.usuarioForm.get("email"))!=null&&L.hasError("required")?24:-1)}},dependencies:[y,mt,st,lt,ut,ft,Ct,ht,_t,ot,tt,et,it,at,rt],styles:[".casilla[_ngcontent-%COMP%]{margin-right:10px}"]})};var x=class t{constructor(e){this.httpClient=e}baseURL=X.ApiBaseURL;getUsuarios(){return this.httpClient.get(`${this.baseURL}/usuarios`)}getById(e){return this.httpClient.get(`${this.baseURL}/usuarios/${e}`)}actualizarUsuarioPorId(e,i){return this.httpClient.patch(`${this.baseURL}/usuarios/${e}`,i).pipe(O(()=>this.getUsuarios()))}removerUsuarioPorId(e){return this.httpClient.delete(`${this.baseURL}/usuarios/${e}`).pipe(O(()=>this.getUsuarios()))}crearUsuario(e){return this.httpClient.post(`${this.baseURL}/usuarios`,I(M({},e),{rol:"Usuario",password:E(8),token:E(20),fecha_creado:new Date().toISOString()}))}static \u0275fac=function(i){return new(i||t)(q(Q))};static \u0275prov=G({token:t,factory:t.\u0275fac,providedIn:"root"})};var A=class t{transform(e,i){let n=e.nombre+" "+e.apellido;return i=="uppercase"?`${n}`.toUpperCase():n}static \u0275fac=function(i){return new(i||t)};static \u0275pipe=z({name:"usuarioNombreCompleto",type:t,pure:!0})};function $t(t,e){t&1&&f(0,"mat-spinner")}function Bt(t,e){t&1&&(o(0,"th",12),r(1," Id "),a())}function Ht(t,e){if(t&1&&(o(0,"td",13),r(1),a()),t&2){let i=e.$implicit;s(),d(" ",i.id," ")}}function Lt(t,e){t&1&&(o(0,"th",12),r(1," Nombre "),a())}function Gt(t,e){if(t&1&&(o(0,"td",13),r(1),$(2,"usuarioNombreCompleto"),a()),t&2){let i=e.$implicit;s(),d(" ",B(2,1,i)," ")}}function qt(t,e){t&1&&(o(0,"th",12),r(1," Email "),a())}function zt(t,e){if(t&1&&(o(0,"td",13),r(1),a()),t&2){let i=e.$implicit;s(),d(" ",i.email," ")}}function Jt(t,e){t&1&&(o(0,"th",12),r(1," Fecha de Creacion "),a())}function Kt(t,e){if(t&1&&(o(0,"td",13),r(1),$(2,"date"),a()),t&2){let i=e.$implicit;s(),d(" ",B(2,1,i.fecha_creado)," ")}}function Qt(t,e){t&1&&(o(0,"th",12),r(1," Acciones "),a())}function Wt(t,e){if(t&1){let i=V();o(0,"td",13)(1,"button",14),_("click",function(){let m=D(i).$implicit,c=C(2);return S(c.mostrarDetalles(m.id))}),o(2,"mat-icon"),r(3,"visibility"),a()(),o(4,"button",14),_("click",function(){let m=D(i).$implicit,c=C(2);return S(c.abrirModal(m))}),o(5,"mat-icon"),r(6,"edit"),a()(),o(7,"button",14),_("click",function(){let m=D(i).$implicit,c=C(2);return S(c.eliminar(m.id))}),o(8,"mat-icon"),r(9,"delete"),a()()()}}function Xt(t,e){t&1&&f(0,"tr",15)}function Yt(t,e){t&1&&f(0,"tr",16)}function Zt(t,e){if(t&1){let i=V();o(0,"button",1),_("click",function(){D(i);let m=C();return S(m.abrirModal())}),o(1,"mat-icon"),r(2,"add"),a(),r(3," Crear Usuario "),a(),o(4,"h2"),r(5,"Tabla Usuarios"),a(),o(6,"table",2),U(7,3),l(8,Bt,2,0,"th",4)(9,Ht,2,1,"td",5),v(),U(10,6),l(11,Lt,2,0,"th",4)(12,Gt,3,3,"td",5),v(),U(13,7),l(14,qt,2,0,"th",4)(15,zt,2,1,"td",5),v(),U(16,8),l(17,Jt,2,0,"th",4)(18,Kt,3,3,"td",5),v(),U(19,9),l(20,Qt,2,0,"th",4)(21,Wt,10,0,"td",5),v(),l(22,Xt,1,0,"tr",10)(23,Yt,1,0,"tr",11),a()}if(t&2){let i=C();s(6),g("dataSource",i.dataSource),s(16),g("matHeaderRowDef",i.displayedColumns),s(),g("matRowDefColumns",i.displayedColumns)}}var k=class t{constructor(e,i,n,m){this.matDialog=e;this.usuariosService=i;this.router=n;this.activatedRoute=m}displayedColumns=["id","nombre","email","fecha_creado","acciones"];dataSource=[];estaCargando=!1;ngOnInit(){this.cargarUsuarios()}cargarUsuarios(){this.estaCargando=!0,this.usuariosService.getUsuarios().subscribe({next:e=>{this.dataSource=e},error:()=>{this.estaCargando=!1},complete:()=>{this.estaCargando=!1}})}abrirModal(e){this.matDialog.open(N,{data:{usuarioEditado:e}}).afterClosed().subscribe({next:i=>{console.log("Recibimos: ",i),i&&(e?this.handleActualizar(e.id,i):this.usuariosService.crearUsuario(i).subscribe({next:()=>this.cargarUsuarios()}))},error:i=>{console.log(i)}})}handleActualizar(e,i){this.estaCargando=!0,this.usuariosService.actualizarUsuarioPorId(e,i).subscribe({next:n=>{this.dataSource=n},error:()=>{this.estaCargando=!1},complete:()=>{this.estaCargando=!1}})}eliminar(e){this.estaCargando=!0,this.usuariosService.removerUsuarioPorId(e).subscribe({next:i=>{this.dataSource=i},error:()=>{this.estaCargando=!1},complete:()=>{this.estaCargando=!1}})}mostrarDetalles(e){this.router.navigate([e,"detalle"],{relativeTo:this.activatedRoute})}static \u0275fac=function(i){return new(i||t)(u(pt),u(x),u(W),u(w))};static \u0275cmp=h({type:t,selectors:[["app-usuarios"]],decls:5,vars:1,consts:[[1,"container"],["mat-raised-button","",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","email"],["matColumnDef","fecha_creado"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,n){i&1&&(o(0,"div",0)(1,"h2"),r(2,"Usuarios"),a(),l(3,$t,1,0,"mat-spinner")(4,Zt,24,3),a()),i&2&&(s(3),p(n.estaCargando?3:4))},dependencies:[y,Y,Z,gt,vt,St,bt,Ut,Et,xt,Dt,Mt,It,Rt,J,A],styles:[".card[_ngcontent-%COMP%]{margin-bottom:10px}"]})};function te(t,e){t&1&&(o(0,"p"),r(1,"Se esta cargando la pagina..."),a())}function ee(t,e){if(t&1&&(o(0,"h1"),r(1),a()),t&2){let i=C();s(),d("Detalle del usuario: ",(i.usuario==null?null:i.usuario.nombre)+" "+(i.usuario==null?null:i.usuario.apellido),"")}}var j=class t{constructor(e,i){this.activatedRoute=e;this.usuariosServicio=i;this.idUsuario=e.snapshot.params.id}idUsuario;usuario;estaCargando=!1;ngOnInit(){this.estaCargando=!0,this.usuariosServicio.getById(this.activatedRoute.snapshot.params.id).subscribe({next:e=>{this.usuario=e,this.estaCargando=!1},error:e=>{console.log(e)}})}static \u0275fac=function(i){return new(i||t)(u(w),u(x))};static \u0275cmp=h({type:t,selectors:[["app-detalle-usuario"]],decls:4,vars:1,template:function(i,n){i&1&&(l(0,te,2,0,"p")(1,ee,2,1,"h1"),o(2,"p"),r(3,"detalle-usuario works!"),a()),i&2&&p(n.estaCargando?0:1)}})};var ie=[{path:"",component:k},{path:":id/detalle",component:j}],P=class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=T({type:t});static \u0275inj=R({imports:[H.forChild(ie),H]})};var Ft=class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=T({type:t});static \u0275inj=R({imports:[K,P,Tt]})};export{Ft as UsuariosModule};
